<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Working with spatial data available through read.abares â€¢ read.abares</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with spatial data available through read.abares">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">read.abares</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/read.abares.html">Working with spatial data available through read.abares</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adamhsparks/read.abares/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Working with spatial data available through read.abares</h1>
                        <h4 data-toc-skip class="author">Adam H.
Sparks</h4>
            
            <h4 data-toc-skip class="date">2025-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/adamhsparks/read.abares/blob/main/vignettes/read.abares.Rmd" class="external-link"><code>vignettes/read.abares.Rmd</code></a></small>
      <div class="d-none name"><code>read.abares.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span>,</span>
<span>  dev <span class="op">=</span> <span class="st">"png"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This vignette demonstrates some of the functionality of {read.abares}
and how to work with some of the spatial and tabular data available
through {read.abares}. Please note that not all functions are
demonstrated here, please refer to the <a href="https://adamhsparks.github.io/read.abares/reference/">documentation
reference</a> for a full list of functionality. The worked examples here
show some of the more advanced features that {read.abares} offers beyond
just fetching and importing data, <em>e.g.</em>, Australian Agricultural
and Grazing Industries Survey (AAGIS) spatial shapefile which can be
used with tabular data from the historical estimates, the Australian
Gridded Farm Data, which can be downloaded, cached and then imported
using one of four types of object or the soil thickness data, which
includes rich metadata.</p>
<p>First we need to load the {read.abares} library.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adamhsparks/read.abares" class="external-link">read.abares</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="working-with-aagis-regions-spatial-data">Working with AAGIS Regions Spatial Data<a class="anchor" aria-label="anchor" href="#working-with-aagis-regions-spatial-data"></a>
</h2>
<div class="section level3">
<h3 id="obtaining-the-aagis-regions-spatial-data">Obtaining the AAGIS Regions Spatial Data<a class="anchor" aria-label="anchor" href="#obtaining-the-aagis-regions-spatial-data"></a>
</h3>
<p>ABARES offers spatial data for the Australian Agricultural and
Grazing Industries Survey (AAGIS) regions that can be used for mapping
tabular data from the estimates, <em>e.g.</em>,
<code><a href="../reference/read_historical_regional_estimates.html">read_historical_regional_estimates()</a></code> or
<code>read_state_estimates()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aagis_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_aagis_regions.html">read_aagis_regions</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">aagis_regions</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/aagis-regions-1.png" alt="plot of chunk aagis-regions"><div class="figcaption">plot of chunk aagis-regions</div>
</div>
</div>
<div class="section level3">
<h3 id="obtaining-aagis-data-by-region">Obtaining AAGIS Data by Region<a class="anchor" aria-label="anchor" href="#obtaining-aagis-data-by-region"></a>
</h3>
<p>{read.abares} offers functions to download the ABARES estimates based
on the AAGIS results for national level,
<code><a href="../reference/read_historical_national_estimates.html">read_historical_national_estimates()</a></code>, regional level
<code><a href="../reference/read_historical_regional_estimates.html">read_historical_regional_estimates()</a></code>, and state level
<code><a href="../reference/read_historical_state_estimates.html">read_historical_state_estimates()</a></code> and also by performance
category <code><a href="../reference/read_estimates_by_performance_category.html">read_estimates_by_performance_category()</a></code> and size
category <code><a href="../reference/read_estimates_by_size.html">read_estimates_by_size()</a></code>. For this example, we
will use the <code><a href="../reference/read_historical_regional_estimates.html">read_historical_regional_estimates()</a></code> function
to download the AAGIS data for the regions in the AAGIS regions
shapefile and join the data and visualise some of the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aagis_region_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_historical_regional_estimates.html">read_historical_regional_estimates</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="merging-the-aagis-regions-spatial-data-with-the-aagis-regional-data">Merging the AAGIS Regions Spatial Data with the AAGIS Regional
Data<a class="anchor" aria-label="anchor" href="#merging-the-aagis-regions-spatial-data-with-the-aagis-regional-data"></a>
</h3>
<p>Using <code><a href="../reference/read_aagis_regions.html">read_aagis_regions()</a></code> and
<code><a href="../reference/read_historical_regional_estimates.html">read_historical_regional_estimates()</a></code>, we can merge the two
datasets together to visualise the data. To join the data, we will use
the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> function from the {dplyr} package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">aagis_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">aagis_regions</span>, <span class="va">aagis_region_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(ABARES_region)`</span></span></code></pre></div>
<p>Once weâ€™ve joined the data, we can visualise it using {ggplot2}. Here
we can plot the total area cropped (ha) and facet by year for all of
Australia.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">total_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">aagis_dat</span>, <span class="va">Variable</span> <span class="op">==</span> <span class="op">(</span><span class="st">"Total area cropped (ha)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">total_area</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"Total Area Cropped (ha)"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/aagis-regions-plot-1.png" alt="plot of chunk aagis-regions-plot"><div class="figcaption">plot of chunk aagis-regions-plot</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-agfd-data">Working With AGFD Data<a class="anchor" aria-label="anchor" href="#working-with-agfd-data"></a>
</h2>
<p>You can download files and pipe directly into the class object that
you desire for the Australian Farm Gridded Data (AGFD) data.</p>
<div class="section level3">
<h3 id="description-of-the-australian-farm-gridded-data">Description of the Australian Farm Gridded Data<a class="anchor" aria-label="anchor" href="#description-of-the-australian-farm-gridded-data"></a>
</h3>
<p>Directly from the DAFF website:</p>
<blockquote>
<p>The Australian Gridded Farm Data are a set of national scale maps
containing simulated data on historical broadacre farm business outcomes
including farm profitability on an 0.05-degree (approximately 5 km)
grid.</p>
</blockquote>
<blockquote>
<p>These data have been produced by read.abares as part of the ongoing
Australian Agricultural Drought Indicator (AADI) project (previously
known as the Drought Early Warning System Project) and were derived
using read.abares farmpredict model, which in turn is based on
read.abares Agricultural and Grazing Industries Survey (AAGIS) data.</p>
</blockquote>
<blockquote>
<p>These maps provide estimates of farm business profit, revenue, costs
and production by location (grid cell) and year for the period 1990-91
to 2022-23. The data do not include actual observed outcomes but rather
model predicted outcomes for representative or â€˜typicalâ€™ broadacre farm
businesses at each location considering likely farm characteristics and
prevailing weather conditions and commodity prices.</p>
</blockquote>
<blockquote>
<p>The Australian Gridded Farm Data remain under active development, and
as such should be considered experimental.</p>
</blockquote>
<p>â€“ Australian Department of Agriculture, Fisheries and Forestry.</p>
<p>Load the {read.abares} library.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adamhsparks/read.abares" class="external-link">read.abares</a></span><span class="op">)</span></span></code></pre></div>
<p>Check the file format information for the NetCDF files.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print_agfd_nc_file_format.html">print_agfd_nc_file_format</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span></code></pre></div>
<p>Download or load from the local cache and read the AGFD files as a
list of {stars} objects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A list of {stars} objects</span></span>
<span><span class="va">star</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agfd.html">get_agfd</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_agfd_stars.html">read_agfd_stars</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">star</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 6 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                         Min.         1st Qu.         Median           Mean</span></span>
<span><span class="co">#&gt; farmno          15612.000000 233091.50000000 329567.0000000 324737.7187618</span></span>
<span><span class="co">#&gt; R_total_hat_ha      2.954396      7.88312157     21.7520529    169.5139301</span></span>
<span><span class="co">#&gt; C_total_hat_ha      1.304440      4.34079101      9.9449849     93.2210542</span></span>
<span><span class="co">#&gt; FBP_fci_hat_ha   -143.759785      3.60529967     11.5796641     76.2928759</span></span>
<span><span class="co">#&gt; FBP_fbp_hat_ha   -349.521639      3.36599833     11.5074294     60.0750936</span></span>
<span><span class="co">#&gt; A_wheat_hat_ha      0.000000      0.04062786      0.1114289      0.1365683</span></span>
<span><span class="co">#&gt;                        3rd Qu.           Max.   NA's</span></span>
<span><span class="co">#&gt; farmno          418508.5000000 669706.0000000 443899</span></span>
<span><span class="co">#&gt; R_total_hat_ha     174.8553843   2415.7556059 443899</span></span>
<span><span class="co">#&gt; C_total_hat_ha      95.7221857   1853.5385298 443899</span></span>
<span><span class="co">#&gt; FBP_fci_hat_ha      77.6748501   1186.5830232 443899</span></span>
<span><span class="co">#&gt; FBP_fbp_hat_ha      62.8596117   1240.6003218 443899</span></span>
<span><span class="co">#&gt; A_wheat_hat_ha       0.2112845      0.5047761 565224</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;     from  to refsys              values x/y</span></span>
<span><span class="co">#&gt; lon    1 886 WGS 84 [886] 112,...,156.2 [x]</span></span>
<span><span class="co">#&gt; lat    1 691 WGS 84 [691] -44.5,...,-10 [y]</span></span></code></pre></div>
<p>Download or load from the local cache and read the AGFD files as a
<code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast</a></code> object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A {terra} `rast` object</span></span>
<span><span class="va">terr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agfd.html">get_agfd</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_agfd_terra.html">read_agfd_terra</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">terr</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 6, 886, 41  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.05, 0.05  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 111.975, 156.275, -10.275, -9.975  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       : farmno, R_tot~at_ha, C_tot~at_ha, FBP_f~at_ha, FBP_f~at_ha, A_whe~at_ha, ... </span></span>
<span><span class="co">#&gt; min values  :    NaN,         NaN,         NaN,         NaN,         NaN,         NaN, ... </span></span>
<span><span class="co">#&gt; max values  :    NaN,         NaN,         NaN,         NaN,         NaN,         NaN, ...</span></span></code></pre></div>
<p>Download or load from the local cache and read the AGFD files as a
list of {tidync} objects.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A list of {tidync} objects</span></span>
<span><span class="va">tdnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_agfd.html">get_agfd</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_agfd_tidync.html">read_agfd_tidync</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tdnc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $source</span></span>
<span><span class="co">#&gt; # A tibble: 1 Ã— 2</span></span>
<span><span class="co">#&gt;   access              source                                                    </span></span>
<span><span class="co">#&gt;   &lt;dttm&gt;              &lt;chr&gt;                                                     </span></span>
<span><span class="co">#&gt; 1 2025-04-01 14:55:04 /Users/283204f/Library/Caches/org.R-project.R/R/read.abarâ€¦</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $axis</span></span>
<span><span class="co">#&gt; # A tibble: 84 Ã— 3</span></span>
<span><span class="co">#&gt;     axis variable       dimension</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1     1 lon                    0</span></span>
<span><span class="co">#&gt;  2     2 lat                    1</span></span>
<span><span class="co">#&gt;  3     3 farmno                 0</span></span>
<span><span class="co">#&gt;  4     4 farmno                 1</span></span>
<span><span class="co">#&gt;  5     5 R_total_hat_ha         0</span></span>
<span><span class="co">#&gt;  6     6 R_total_hat_ha         1</span></span>
<span><span class="co">#&gt;  7     7 C_total_hat_ha         0</span></span>
<span><span class="co">#&gt;  8     8 C_total_hat_ha         1</span></span>
<span><span class="co">#&gt;  9     9 FBP_fci_hat_ha         0</span></span>
<span><span class="co">#&gt; 10    10 FBP_fci_hat_ha         1</span></span>
<span><span class="co">#&gt; # â„¹ 74 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grid</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 4</span></span>
<span><span class="co">#&gt;   grid  ndims variables         nvars</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;int&gt; &lt;list&gt;            &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 D0,D1     2 &lt;tibble [41 Ã— 1]&gt;    41</span></span>
<span><span class="co">#&gt; 2 D0        1 &lt;tibble [1 Ã— 1]&gt;      1</span></span>
<span><span class="co">#&gt; 3 D1        1 &lt;tibble [1 Ã— 1]&gt;      1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dimension</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 8</span></span>
<span><span class="co">#&gt;      id name  length unlim coord_dim active start count</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt;     &lt;lgl&gt;  &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1     0 lon      886 FALSE TRUE      TRUE       1   886</span></span>
<span><span class="co">#&gt; 2     1 lat      691 FALSE TRUE      TRUE       1   691</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $variable</span></span>
<span><span class="co">#&gt; # A tibble: 43 Ã— 7</span></span>
<span><span class="co">#&gt;       id name            type      ndims natts dim_coord active</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt; </span></span>
<span><span class="co">#&gt;  1     0 lon             NC_DOUBLE     1     2 TRUE      FALSE </span></span>
<span><span class="co">#&gt;  2     1 lat             NC_DOUBLE     1     2 TRUE      FALSE </span></span>
<span><span class="co">#&gt;  3     2 farmno          NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt;  4     3 R_total_hat_ha  NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt;  5     4 C_total_hat_ha  NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt;  6     5 FBP_fci_hat_ha  NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt;  7     6 FBP_fbp_hat_ha  NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt;  8     7 A_wheat_hat_ha  NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt;  9     8 H_wheat_dot_hat NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt; 10     9 A_barley_hat_ha NC_DOUBLE     2     1 FALSE     TRUE  </span></span>
<span><span class="co">#&gt; # â„¹ 33 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $attribute</span></span>
<span><span class="co">#&gt; # A tibble: 49 Ã— 4</span></span>
<span><span class="co">#&gt;       id name       variable       value       </span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;named list&gt;</span></span>
<span><span class="co">#&gt;  1     0 _FillValue lon            &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt;  2     1 units      lon            &lt;chr [1]&gt;   </span></span>
<span><span class="co">#&gt;  3     0 _FillValue lat            &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt;  4     1 units      lat            &lt;chr [1]&gt;   </span></span>
<span><span class="co">#&gt;  5     0 _FillValue farmno         &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt;  6     0 _FillValue R_total_hat_ha &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt;  7     0 _FillValue C_total_hat_ha &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt;  8     0 _FillValue FBP_fci_hat_ha &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt;  9     0 _FillValue FBP_fbp_hat_ha &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt; 10     0 _FillValue A_wheat_hat_ha &lt;dbl [1]&gt;   </span></span>
<span><span class="co">#&gt; # â„¹ 39 more rows</span></span></code></pre></div>
<p>Download or load from the local cache and read the AGFD files as a
{data.table} object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A {data.table} object</span></span>
<span><span class="fu"><a href="../reference/get_agfd.html">get_agfd</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_agfd_dt.html">read_agfd_dt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in head(read_agfd_dt(get_agfd(cache = TRUE))): internal error 1 in</span></span>
<span><span class="co">#&gt; R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error in head(read_agfd_dt(get_agfd(cache = TRUE))): lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-the-soil-thickness-map">Working With the Soil Thickness Map<a class="anchor" aria-label="anchor" href="#working-with-the-soil-thickness-map"></a>
</h2>
<p>You can download the soil depth map and import it as a {stars} or
[terra::rast()] object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adamhsparks/read.abares" class="external-link">read.abares</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_topsoil_thickness.html">get_topsoil_thickness</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_topsoil_thickness_stars.html">read_topsoil_thickness_stars</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_topsoil_thickness.html">get_topsoil_thickness</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_topsoil_thickness_terra.html">read_topsoil_thickness_terra</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span></code></pre></div>
<p>For your convenience, {read.abares} re-exports [terra::plot()], so
you can just use <code><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot()</a></code> with the {terra} objects in
{read.abares}.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'plot': object 'x' not found</span></span></code></pre></div>
<div class="section level3">
<h3 id="soil-thickness-metadata">Soil Thickness Metadata<a class="anchor" aria-label="anchor" href="#soil-thickness-metadata"></a>
</h3>
<p>By default, a brief bit of metadata is printed to the console when
you call the topsoil thickness object in your R session.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adamhsparks/read.abares" class="external-link">read.abares</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_topsoil_thickness.html">get_topsoil_thickness</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span></code></pre></div>
<p>But, {read.abares} provides a function for you to browse the topsoil
thickness metadata in your console.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adamhsparks/read.abares" class="external-link">read.abares</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_topsoil_thickness.html">get_topsoil_thickness</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/print_topsoil_thickness_metadata.html">print_topsoil_thickness_metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span></code></pre></div>
<p>But you can also access it directly and use [pander::pander()] to
include it in a document like this vignette.</p>
<blockquote>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adamhsparks/read.abares" class="external-link">read.abares</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_topsoil_thickness.html">get_topsoil_thickness</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: restarting interrupted promise evaluation</span></span>
<span><span class="co">#&gt; Warning: internal error 1 in R_decompress1 with libdeflate</span></span>
<span><span class="co">#&gt; Error: lazy-load database '/Users/283204f/Library/R/arm64/4.4/library/read.abares/R/read.abares.rdb' is corrupt</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">metadata</span></span>
<span><span class="co">#&gt; Error: object 'x' not found</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: object 'y' not found</span></span>
<span><span class="co">#&gt; Error in if (tail(stdout, 1) == "") {: argument is of length zero</span></span></code></pre></div>
</blockquote>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam H. Sparks, Grains Research and Development Corporation.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
